<div *ngIf="recipe">

  <mat-card>
    <mat-card-title>{{recipe.title}}</mat-card-title>

    <div *ngIf="checkIfYourComment(recipe.createdBy.username)" class="pad">
      <button style="margin-right: 5px" mat-raised-button (click)="deleteRecipe()">Usuń</button>
      <button mat-raised-button (click)="editRecipe()">Edytuj</button>
    </div>

    <mat-card-content>
      
      <div>
        Stworzono przez: <a routerLink="/profiles/{{recipe.createdBy.username}}" >{{recipe.createdBy.username}}</a>
      </div>
      <p>
        <span style="color: #888">Kategoria: </span>{{recipe.category}}<br />
        <span style="color: #888">Typ kuchni: </span>{{recipe.cuisine}}
      </p>
      <p>
        {{recipe.description}}
      </p>

      <div>
        Dania spróbujesz w restauracjach:
        <mat-list>
          <mat-list-item *ngFor="let restaurant of recipe.restaurants">
            <p>{{restaurant.name}}</p>
          </mat-list-item>
        </mat-list>
      </div>

      <mat-accordion multi="true">
        
        <mat-expansion-panel >
          
          <mat-expansion-panel-header>
            <mat-panel-title>Składniki</mat-panel-title>
          </mat-expansion-panel-header>

          <mat-list>
            <mat-list-item *ngFor="let ingredient of recipe.ingredients">
              <p>{{ingredient.name}}: {{ingredient.amount}} {{ingredient.unit}}</p>
            </mat-list-item>
          </mat-list>

        </mat-expansion-panel>


        <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
          <mat-expansion-panel-header>
            
            <mat-panel-title>
              Krok po kroku
            </mat-panel-title>

          </mat-expansion-panel-header>
          <mat-list-item *ngFor="let step of recipe.steps">
            <h4 mat-line>Krok {{step.id}}</h4>
            <p mat-line> {{step.description}} </p>
          </mat-list-item>
        </mat-expansion-panel>
      </mat-accordion>


      <div>
        <form [formGroup]="createCommentForm" novalidate (ngSubmit)="addComments()">
          <mat-form-field class="example-full-width">
            <input matInput placeholder="Skomentuj" formControlName="commentInput">
          </mat-form-field>

          <mat-card-actions align="center">
            <button mat-raised-button color="primary" [disabled]="!createCommentForm.valid">Add</button>
          </mat-card-actions>
        </form>
      </div>

      <mat-list>
        <mat-list-item *ngFor="let comment of allComments">
          
          <p>{{comment.comment}}</p>
          <span style="color: #888; font-size: 11px; margin: 10px;">{{comment.users.username}}, {{comment.date}}</span>
          
          <span *ngIf="checkIfYourComment(comment.users.username)" (click)="deleteComment(comment)"><i class="material-icons">delete</i></span>
          <mat-divider></mat-divider>
        </mat-list-item>
      </mat-list>

    </mat-card-content>

  </mat-card>

</div>

